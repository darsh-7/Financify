# Home Screen â€“ Dashboard Overview

This documentation describes the technical implementation of the Home Screen (Dashboard) in the Financify application. The screen provides real-time financial insights by aggregating data from multiple repositories and displaying key metrics such as total balance, recent transactions, savings progress, and income sources.

## 1. Overview

The Home Screen acts as the primary entry point of the Financify user experience.

**User Flow:**
- Application launches and navigates to the Home Screen.
- HomeViewModel retrieves real-time data from local Room Database.
- UI updates automatically using StateFlow.

**User can navigate to:**
- Add Transaction
- Transaction List
- Saving Goals
- Text Recognition (Receipt Scanning)
- Analysis Screen

The goal of this screen is to give users a clear understanding of their financial status at a glance.

## 2. Architecture

The feature is fully built using the MVVM (Model-View-ViewModel) architecture.

### 2.1 Key Components

| Layer | File/Class | Responsibility |
|-------|------------|-----------------|
| UI Layer | HomeScreen.kt | Displays the dashboard widgets and handles navigation. |
| ViewModel | HomeViewModel.kt | Retrieves and transforms data from repositories using StateFlow. |
| Data Layer | SavingGoalRepository.kt, TransactionRepository.kt | Exposes data from DAOs using Kotlin Flows. |
| Persistence | Room Database | Stores all transactions and saving goals. |

## 3. HomeViewModel Implementation Details

The HomeViewModel aggregates multiple asynchronous data streams from the Room database and exposes them as StateFlow for Compose UI.

### 3.1. Total Balance

```kotlin
val totalBalance: StateFlow<Double> = transactionRepo.getAllTransactions()
    .map { transactions ->
        transactions.sumOf { if (it.type == TransactionType.INCOME) it.amount else -it.amount }
    }
    .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), 0.0)


    Responsibilities: 

     Observes all transactions.
     Calculates total income minus expenses.
     Emits real-time updates to the UI.
     

3.2. Recent Transactions 

```kotlin
val recentTransactions: StateFlow<List<Transaction>> = transactionRepo.getAllTransactions()
    .map { transactions -> transactions.sortedByDescending { it.date }.take(4) }
    .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), emptyList())


    Responsibilities: 

     Retrieves the latest 4 transactions.
     Ensures sorting by date.
     Updates UI automatically when database changes.
     

3.3. Recent Savings 
```kotlin
val recentSavings: StateFlow<List<SavingGoal>> = savingRepo.getAllGoals()
    .map { goals -> goals.take(4) }
    .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), emptyList())

    Responsibilities: 

     Displays recent saving goals.
     Helps users track progress on active goals.
     

3.4. Income Sources 
```kotlin
val incomeSources: StateFlow<List<Transaction>> = transactionRepo.getAllTransactions()
    .map { transactions -> transactions.filter { it.type == TransactionType.INCOME } }
    .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), emptyList())

    Responsibilities: 

     Filters income-only transactions.
     Used for categorized financial insights and visualizations.
     
     ```markdown
## 4. Navigation Behavior

The Home Screen provides navigation to:

| Destination | Trigger |
|-------------|---------|
| Add Transaction | Floating action button |
| Transaction List | Recent transactions widget |
| Saving Goals | Savings section |
| Receipt Scanning | Text Recognition button |
| Analysis Screen | Insights button |

Navigation is handled through Compose Navigation:

```kotlin
navController.navigate(Screens.TransactionListScreen.route)

5. HomeViewModelFactory 

A custom ViewModelFactory is used to pass repositories into the ViewModel: 
```kotlin
class HomeViewModelFactory(
    private val savingRepo: SavingGoalRepository,
    private val transactionRepo: TransactionRepository
) : ViewModelProvider.Factory {
    override fun <T : ViewModel> create(modelClass: Class<T>): T {
        if (modelClass.isAssignableFrom(HomeViewModel::class.java)) {
            return HomeViewModel(savingRepo, transactionRepo) as T
        }
        throw IllegalArgumentException("Unknown ViewModel class")
    }
}

This ensures: 

     Dependency injection compatibility.
     Clean separation between ViewModel and data layer.
     Easy testing and mock replacement.
     

6. Data Sources 

The Home Screen relies on: 
| Source | Description |
|--------|-------------|
| TransactionDao | Provides flows of financial transactions. |
| SavingGoalDao | Provides flows of saving goals. |
| Room Database | Stores all local app data. |

7. Dependencies 
Real-time updates are powered by Room's Flow integration. 

Ensure the following libraries are available: 

```kotlin
// Lifecycle and ViewModel
implementation "androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.2"

// Kotlin Coroutines
implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3"

// Room
implementation "androidx.room:room-ktx:2.6.0"

// Compose Navigation
implementation "androidx.navigation:navigation-compose:2.7.2"

8. Summary 

The Home Screen is designed as a reactive financial dashboard powered entirely by StateFlow and Room Database. 

The architecture ensures: 

     Real-time UI updates
     Clean and testable ViewModel logic
     Fully decoupled data and UI layers
     